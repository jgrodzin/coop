%h4= "#{current_member.first_name}'s cart"
%br

%p= link_to "Back to event products", event_shopping_carts_path(@event)

- if @sorted_cart_items.empty?
  %h3 No items in cart yet!
-else
  .cart-items-table
    %table{:cellpadding => "0", :cellspacing => "0"}
      %tbody
        %tr
          %th Product name
          %th Price / Unit
          %th Amount
          %th Total
          %th Update
          %th Remove from cart
        - @sorted_cart_items.each do |cart_item|
          = form_for cart_item, url: event_shopping_cart_cart_item_path(@event, @shopping_cart, cart_item), method: :patch do |f|
            %tr
              %td= cart_item.product.name
              %td= "#{humanized_money_with_symbol(cart_item.product.price)} / #{cart_item.product.unit_type}"
              %td.cart-item-amount
                = f.text_field :amount
              %td.cart-item-total
                = humanized_money_with_symbol(cart_item.calculate_sub_total_price)
              %td
                = f.submit "Update"
              %td
                = link_to "Delete", event_shopping_cart_cart_item_path(@event, @shopping_cart, cart_item), data: { confirm: "Remove #{cart_item.product.name} from cart?"}, method: :delete

        %tr.tax-box
          %th Pre-tax
          %th
          %th
          %th= humanized_money_with_symbol(@shopping_cart.sub_total_price)
          %th
        %tr
          %th Tax
          %th
          %th (0.0225)
          %th= "+ #{humanized_money_with_symbol(@shopping_cart.tax)}"
          %th
        %tr.cart-total
          %th Cart total
          %th
          %th
          %th= humanized_money_with_symbol(@shopping_cart.total)
          %th
